<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Invoice Generator with HS Code</title>
    <link rel="stylesheet" href="https://public.codepenassets.com/css/normalize-5.0.0.min.css"> 
    <link rel="stylesheet" href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.css">
    <link rel="stylesheet" href="https://unpkg.com/filepond/dist/filepond.min.css">
    <link rel="stylesheet" href="https://pyscript.net/releases/2025.8.1/core.css" />
    <script type="module" src="https://pyscript.net/releases/2025.8.1/core.js"></script>
    
    <style>
        .filepond--drop-label { color: #4c4e53; }
        .filepond--label-action { text-decoration-color: #babdc0; }
        .filepond--panel-root { border-radius: 2em; background-color: #edf0f4; height: 1em; }
        .filepond--item-panel { background-color: #595e68; }
        .filepond--drip-blob { background-color: #7f8a9a; }
        
        html { padding: 30vh 0 0; }
        body { max-width: 90%; margin: 0 auto; font-family: Arial, sans-serif; }
        h2 { text-align: center; }
        .filepond-container { max-width: 20em; margin: 0 auto; }
        #sheet { margin-top: 2em; margin-bottom: 4em; overflow-x: auto; }
        #sheet table { border-collapse: collapse; width: 100%; margin-top: 1em; }
        #sheet th, #sheet td { border: 1px solid #ddd; padding: 8px; text-align: left; font-size: 0.8em; }
        #sheet th { background-color: #ffffff; }
        #sheet tr:nth-child(even) { background-color: #f2f2f2; }
        #loading { display: none; color: #595e68; font-style: italic; margin-top: 1em; text-align: center; }
    </style>
</head>
  
<body>
    <div class="filepond-container">
        <h2>Upload Excel File (.xlsx)</h2>
        <input type="file" class="filepond" name="filepond" accept=".xlsx,.xls" data-max-file-size="10MB" data-max-files="1">
    </div>
    <div id="loading">Processing file...</div>
    <div id="sheet"></div>
  
    <script src="https://unpkg.com/filepond-plugin-image-exif-orientation/dist/filepond-plugin-image-exif-orientation.min.js"></script>
    <script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.min.js"></script>
  
    <py-config>
        packages = ["pandas", "openpyxl"]   
    </py-config>

    <script type="py">
        import js
        import pandas as pd
        from pyodide.ffi import create_proxy
        import base64, io, re
    
        # ─────────────────────────────────────────────────────────────
        # HS CODE RULES — EDIT HERE
        # ─────────────────────────────────────────────────────────────
        HS_CODE_RULES = [

        # ─────────────────────────────────────────────────────────────────────
        # 1 - JACKET RULES
        # ─────────────────────────────────────────────────────────────────────

        # ─────────────────────────────────────────────────────────────────────
        # 1.1.1 - JACKET - KNIT - JACKET
        # ─────────────────────────────────────────────────────────────────────

        # Jacket (Men), Knit, Wool
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61033100"
        },    
        
        # Jacket (Men), Knit, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61033200"
        },   
        
        # Jacket (Men), Knit, Synthetic
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "61033300"
        },    

        # Jacket (Men), Knit, Artificial
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "61033910"
        },    
        
        # Jacket (Men), Knit, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "61033990"
        },

        # Jacket (Women/Unisex), Knit, Wool
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61043100"
        },

        # Jacket (Women/Unisex), Knit, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61043200"
        },

        # Jacket (Women/Unisex), Knit, Synthetic
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61043300"
        },

        # Jacket (Women/Unisex), Knit, Artificial
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61043910"
        },
        
        # Jacket (Women/Unisex), Knit, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "61033990"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 1.1.2 - JACKET - KNIT - VEST
        # ─────────────────────────────────────────────────────────────────────

        # Vest (Men), Knit, Wool
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61101110"
        },   

        # Vest (Men), Knit, Cashmere
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cashmere",
            "hs_code": "61101210"
        },   

        # Vest (Men), Knit, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61102010"
        },   

        # Vest (Men), Knit, Man-made 
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "61103010"
        },   

        # Vest (Men), Knit, Silk
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "61109010"
        },   

        # Vest (Men), Knit, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "61109080"
        },   

        # Vest (Women/Unisex), Knit, Wool
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61101120"
        },   

        # Vest (Women/Unisex), Knit, Cashmere
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cashmere",
            "hs_code": "61101220"
        },   

        # Vest (Women/Unisex), Knit, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61102020"
        },   

        # Vest (Women/Unisex), Knit, Man-made 
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "61103020"
        },   

        # Vest (Women/Unisex), Knit, Silk
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61109020"
        },   

        # Vest (Women/Unisex), Knit, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "61109090"
        },   


        # ─────────────────────────────────────────────────────────────────────
        # 1.2.1 - JACKET - WOVEN - JACKET
        # ─────────────────────────────────────────────────────────────────────

        # Jacket (Men), Woven, Wool
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62033100"
        },    

        # Denim Jacket (Men), Woven, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62033210"
        },    
        
        # Jacket (Men), Woven, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62033290"
        },   
        
        # Jacket (Men), Woven, Synthetic
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "62033300"
        },    

        # Jacket (Men), Woven, Artificial
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "62033910"
        },    

        # Jacket (Men), Woven, Silk
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62033920"
        },    
        
        # Jacket (Men), Woven, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "62033990"
        },

        # Jacket (Women/Unisex), Woven, Wool
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62043100"
        },

        # Denim Jacket (Women/Unisex), Woven, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62043210"
        },

        # Jacket (Women/Unisex), Woven, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62043290"
        },

        # Jacket (Women/Unisex), Woven, Synthetic
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62043300"
        },

        # Jacket (Women/Unisex), Woven, Artificial
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62043910"
        },

        # Jacket (Women/Unisex), Woven, Silk
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62043920"
        },
        
        # Jacket (Women/Unisex), Woven, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Vest",
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "62043990"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 1.2.2 - JACKET - WOVEN - VEST
        # ─────────────────────────────────────────────────────────────────────

        # Vest (Men), Knit, Wool
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62113290"
        },   

        # Vest (Men), Knit, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62113390"
        },   

        # Vest (Men), Knit, Man-made 
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "62113910"
        },   

        # Vest (Men), Knit, Silk
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62113920"
        },   

        # Vest (Men), Knit, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "62113990"
        },   

        # Vest (Women/Unisex), Knit, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62114290"
        },   

        # Vest (Women/Unisex), Knit, Man-made 
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "62114390"
        },   

        # Vest (Women/Unisex), Knit, Silk
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62114910"
        },   

        # Vest (Women/Unisex), Knit, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": r"Vest",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "62114990"
        },   


        # ─────────────────────────────────────────────────────────────────────
        # 2 - COAT RULES
        # ─────────────────────────────────────────────────────────────────────

        # ─────────────────────────────────────────────────────────────────────
        # 2.1 - COAT - KNIT
        # ─────────────────────────────────────────────────────────────────────

        # Coat (Men), Knit, Wool
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61019010"
        },   

        # Coat (Men), Knit, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61012000"
        },   

        # Coat (Men), Knit, Man-made
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "61013000"
        },   

        # Coat (Men), Knit, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "61019090"
        },   

        # Coat (Women/Unisex), Knit, Wool
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61021000"
        },   

        # Coat (Women/Unisex), Knit, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61022000"
        },   

        # Coat (Women/Unisex), Knit, Man-made
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "61023000"
        },   

        # Coat (Women/Unisex), Knit, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "61029000"
        },   


        # ─────────────────────────────────────────────────────────────────────
        # 2.2 - COAT - WOVEN
        # ─────────────────────────────────────────────────────────────────────

        # Coat (Men), Woven, Wool
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62012000"
        },   

        # Denim Coat (Men), Woven, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62013020"
        },   

        # Coat (Men), Woven, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62013090"
        },   

        # Coat (Men), Woven, Man-made
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "62014090"
        },   

        # Coat (Men), Woven, Silk
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62019010"
        },  

        # Coat (Men), Woven, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "62019090"
        },   

        # Coat (Women/Unisex), Woven, Wool
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62022000"
        },   

        # Denim Coat (Women/Unisex), Woven, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62023020"
        },   

        # Coat (Women/Unisex), Woven, Cotton
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62023090"
        },   

        # Coat (Women/Unisex), Woven, Man-made
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "62024090"
        },   

        # Coat (Women/Unisex), Woven, Silk
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62029010"
        },  

        # Coat (Women/Unisex), Woven, Other Material
        {
            "product_digit": "1",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "62029090"
        },   


        # ─────────────────────────────────────────────────────────────────────
        # 3 - SHIRT RULES
        # ─────────────────────────────────────────────────────────────────────

        # ─────────────────────────────────────────────────────────────────────
        # 3.1.1 - SHIRT - KNIT - SHIRT
        # ─────────────────────────────────────────────────────────────────────           
        
        # Shirt (Men), Knit, Wool
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61059010"
        },

        # Shirt (Men), Knit, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61051010"
        },
        
        # Shirt (Men), Knit, Man-made
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "61052010"
        },

        # Shirt (Men), Knit, Silk
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "61059030"
        },

        # Shirt (Men), Knit, Other Material
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "61059080"
        },

        # Shirt (Women/Unisex), Knit, Wool
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61069010"
        },

        # Shirt (Women/Unisex), Knit, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61061000"
        },
        
        # Shirt (Women/Unisex), Knit, Man-made
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "61062000"
        },

        # Shirt (Women/Unisex), Knit, Silk
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61069020"
        },

        # Shirt (Women/Unisex), Knit, Other Material
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "61069090"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 3.1.2 - SHIRT - KNIT - CAMISOLE
        # ─────────────────────────────────────────────────────────────────────    

        # Camisole (Men), Knit, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61091020"
        },
        
        # Camisole (Men), Knit, Man-made
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "61099020"
        },

        # Camisole (Men), Knit, Silk
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "61099040"
        },

        # Camisole (Men), Knit, Other Material
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "61099052"
        },

        # Camisole (Women/Unisex), Knit, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61091030"
        },
        
        # Camisole (Women/Unisex), Knit, Man-made
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "61099030"
        },

        # Camisole (Women/Unisex), Knit, Silk
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61099040"
        },

        # Camisole (Women/Unisex), Knit, Other Material
        {
            "product_digit": "3",
            "knit_woven": "Knit",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "61099053"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 3.2.1 - SHIRT - WOVEN - SHIRT
        # ───────────────────────────────────────────────────────────────────── 

        # Shirt (Men), Woven, Wool
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62059030"
        },

        # Denim Shirt (Men), Woven, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62052010"
        },

        # Shirt (Men), Woven, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62052020"
        },
        
        # Shirt (Men), Woven, Man-made
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "62053010"
        },

        # Shirt (Men), Woven, Silk
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62059010"
        },

        # Shirt (Men), Woven, Other Material
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "62059080"
        },

        # Shirt (Women/Unisex), Woven, Wool
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62062010"
        },

        # Shirt (Women/Unisex), Woven, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62063010"
        },
        
        # Shirt (Women/Unisex), Woven, Man-made
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "62064010"
        },

        # Shirt (Women/Unisex), Woven, Silk
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62061010"
        },

        # Shirt (Women/Unisex), Woven, Other Material
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Camisole",
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "62069010"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 3.2.2 - SHIRT - WOVEN - CAMISOLE
        # ───────────────────────────────────────────────────────────────────── 

        # Camisole (Men), Woven, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62079110"
        },
        
        # Camisole (Men), Woven, Man-made
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "62079940"
        },

        # Camisole (Men), Woven, Silk
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62079930"
        },

        # Camisole (Men), Woven, Other Material
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "62079991"
        },

        # Camisole (Women/Unisex), Woven, Cotton
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62089110"
        },
        
        # Camisole (Women/Unisex), Woven, Man-made
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "62089210"
        },

        # Camisole (Women/Unisex), Woven, Silk
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62089930"
        },

        # Camisole (Women/Unisex), Woven, Other Material
        {
            "product_digit": "3",
            "knit_woven": "Woven",
            "product_type_includes": r"Camisole",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "62089991"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 4 - SKIRT RULES
        # ─────────────────────────────────────────────────────────────────────
        
        # ─────────────────────────────────────────────────────────────────────
        # 4.1.1 - SKIRT - KNIT - SKIRT
        # ─────────────────────────────────────────────────────────────────────     

        # Skirt (Women), Knit, Wool
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61045100"
        },

        # Skirt (Women), Knit, Cotton
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61045200"
        },

        # Skirt (Women), Knit, Synthetic
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61045300"
        },

        # Skirt (Women), Knit, Artificial
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61045910"
        },

        # Skirt (Women), Knit, Silk
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61045920"
        },

        # Skirt (Women), Knit, Other Materials
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "61045990"
        },
        

        # ─────────────────────────────────────────────────────────────────────
        # 4.1.2 - SKIRT - KNIT - PANTS
        # ─────────────────────────────────────────────────────────────────────     

        # Pants (Women), Knit, Wool
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61046110"
        },

        # Pants (Women), Knit, Cotton
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61046210"
        },

        # Pants (Women), Knit, Synthetic
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61046310"
        },

        # Pants (Women), Knit, Artificial
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61046910"
        },

        # Pants (Women), Knit, Other Materials
        {
            "product_digit": "4",
            "knit_woven": "Knit",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "61046980"
        },

        # ─────────────────────────────────────────────────────────────────────
        # 4.2.1 - SKIRT - WOVEN - SKIRT
        # ─────────────────────────────────────────────────────────────────────     

        # Skirt (Women), Woven, Wool
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62045100"
        },

        # Denim Skirt (Women), Woven, Cotton
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62045210"
        },

        # Skirt (Women), Woven, Cotton
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62045290"
        },

        # Skirt (Women), Woven, Synthetic
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62045300"
        },

        # Skirt (Women), Woven, Artificial
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62045910"
        },

        # Skirt (Women), Woven, Silk
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62045920"
        },

        # Skirt (Women), Woven, Other Material
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Pants",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62045990"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 4.2.2 - SKIRT - WOVEN - PANTS
        # ─────────────────────────────────────────────────────────────────────   

        # Pants (Women), Woven, Wool
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62046110"
        },

        # Denim Pants (Women), Woven, Cotton
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": r"Skirt|Tablier|Culottes",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62046210"
        },

        # Pants (Women/Unisex), Woven, Cotton
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62046280"
        },

        # Pants (Women), Woven, Synthetic
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62046310"
        },

        # Pants (Women), Woven, Artificial
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62046910"
        },

        # Pants (Women), Woven, Silk
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62046930"
        },

        # Pants (Women), Woven, Other Materials
        {
            "product_digit": "4",
            "knit_woven": "Woven",
            "product_type_includes": r"Pants",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "62046980"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 5 - DRESS RULES
        # ─────────────────────────────────────────────────────────────────────

        # ─────────────────────────────────────────────────────────────────────
        # 5.1 - DRESS - KNIT
        # ─────────────────────────────────────────────────────────────────────

        # Dress (Women), Knit, Wool
        {
            "product_digit": "5",
            "knit_woven": "Knit",
            "product_type_includes": r"Dress",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61044100"
        },

        # Dress (Women), Knit, Cotton
        {
            "product_digit": "5",
            "knit_woven": "Knit",
            "product_type_includes": r"Dress",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61044200"
        },

        # Dress (Women), Knit, Synthetic
        {
            "product_digit": "5",
            "knit_woven": "Knit",
            "product_type_includes": r"Dress",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61044300"
        },

        # Dress (Women), Knit, Artificial
        {
            "product_digit": "5",
            "knit_woven": "Knit",
            "product_type_includes": r"Dress",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61044400"
        },

        # Dress (Women), Knit, Silk
        {
            "product_digit": "5",
            "knit_woven": "Knit",
            "product_type_includes": r"Dress",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61044910"
        },

        # Dress (Women), Knit, Other Material
        {
            "product_digit": "5",
            "knit_woven": "Knit",
            "product_type_includes": r"Dress",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61044990"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 5.2 - DRESS - WOVEN
        # ─────────────────────────────────────────────────────────────────────

        # Dress (Women), Woven, Wool
        {
            "product_digit": "5",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62044100"
        },

        # Denim Dress (Women), Woven, Cotton
        {
            "product_digit": "5",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62044210"
        },

        # Dress (Women), Woven, Cotton
        {
            "product_digit": "5",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62044290"
        },

        # Dress (Women), Woven, Synthetic
        {
            "product_digit": "5",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62044300"
        },

        # Dress (Women), Woven, Artificial
        {
            "product_digit": "5",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62044400"
        },

        # Dress (Women), Woven, Silk
        {
            "product_digit": "5",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62044910"
        },

        # Dress (Women), Woven, Other Material
        {
            "product_digit": "5",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62044990"
        },


        # ─────────────────────────────────────────────────────────────────────
        # 6 - PANTS RULES
        # ─────────────────────────────────────────────────────────────────────
        
        # ─────────────────────────────────────────────────────────────────────
        # 6.1.1 - PANTS - KNIT - PANTS
        # ─────────────────────────────────────────────────────────────────────

        # Pants (Men), Knit, Wool 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61034110"
        },

        # Pants (Men), Knit, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61034210"
        },

        # Pants (Men), Knit, Synthetic 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "61034310"
        },

        # Pants (Men), Knit, Artificial 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "61034910"
        },

        # Pants (Men), Knit, Other Material 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "61034980"
        },

        # Pants (Women/Unisex), Knit, Wool 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61046110"
        },

        # Pants (Women/Unisex), Knit, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61046210"
        },

        # Pants (Women/Unisex), Knit, Synthetic 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61046310"
        },

        # Pants (Women/Unisex), Knit, Artificial 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61046910"
        },

        # Pants (Women/Unisex), Knit, Other Material 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61046980"
        },

        # ─────────────────────────────────────────────────────────────────────
        # 6.1.2 - PANTS - KNIT - BIBS
        # ─────────────────────────────────────────────────────────────────────

        # Pants (Men), Knit, Wool 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61034120"
        },

        # Pants (Men), Knit, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61034220"
        },

        # Pants (Men), Knit, Synthetic 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "61034320"
        },

        # Pants (Men), Knit, Artificial 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "61034920"
        },

        # Pants (Men), Knit, Other Material 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "61034990"
        },

        # Pants (Women/Unisex), Knit, Wool 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61046120"
        },

        # Pants (Women/Unisex), Knit, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61046220"
        },

        # Pants (Women/Unisex), Knit, Synthetic 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61046320"
        },

        # Pants (Women/Unisex), Knit, Artificial 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61046920"
        },

        # Pants (Women/Unisex), Knit, Silk 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61046930"
        },

        # Pants (Women/Unisex), Knit, Other Material 
        {
            "product_digit": "6",
            "knit_woven": "Knit",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61046990"
        },

        # ─────────────────────────────────────────────────────────────────────
        # 6.2.1 - PANTS - WOVEN - PANTS
        # ─────────────────────────────────────────────────────────────────────


        # Pants (Men), Woven, Wool 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62034110"
        },

        # Denim Jeans/Pants (Men), Woven, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62034210"
        },

        # Pants (Men), Woven, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62034240"
        },

        # Pants (Men), Woven, Synthetic 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "62034319"
        },

        # Pants (Men), Woven, Artificial 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "62034942"
        },

        # Pants (Men), Woven, Silk 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62034943"
        },

        # Pants (Men), Woven, Other Material 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "62034949"
        },

        # Pants (Women/Unisex), Woven, Wool 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62046110"
        },

        # Denim Jeans/Pants (Women/Unisex), Woven, Cotton
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Denim|Futatabi6.5|Momohime|Sorahikohime|Charlotte5",
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62046210"
        },

        # Pants (Women/Unisex), Woven, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62046280"
        },

        # Pants (Women/Unisex), Woven, Synthetic 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62046310"
        },

        # Pants (Women/Unisex), Woven, Artificial 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62046910"
        },

        # Pants (Women/Unisex), Woven, Silk 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62046930"
        },

        # Pants (Women/Unisex), Woven, Other Material 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": None,
            "product_type_excludes": r"Overall|Jumpsuit",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62046980"
        },

        # ─────────────────────────────────────────────────────────────────────
        # 6.2.2 - PANTS - WOVEN - BIBS
        # ─────────────────────────────────────────────────────────────────────

        # Pants (Men), Woven, Wool 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62034120"
        },

        # Denim Jeans/Pants (Men), Woven, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"(Denim*Overall)|(Futatabi6.5*Overall)|(Momohime*Overall)|(Sorahikohime*Overall)|(Charlotte5*Overall)|(Denim*Jumpsuit)|(Futatabi6.5*Jumpsuit)|(Momohime*Jumpsuit)|(Sorahikohime*Jumpsuit)|(Charlotte5*Jumpsuit)",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62034220"
        },

        # Pants (Men), Woven, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62034250"
        },

        # Pants (Men), Woven, Synthetic 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "62034320"
        },

        # Pants (Men), Woven, Artificial 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "62034920"
        },

        # Pants (Men), Woven, Other Material 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "62034990"
        },

        # Pants (Women/Unisex), Woven, Wool 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62046120"
        },

        # Denim Jeans/Pants (Women/Unisex), Woven, Cotton
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"(Denim*Overall)|(Futatabi6.5*Overall)|(Momohime*Overall)|(Sorahikohime*Overall)|(Charlotte5*Overall)|(Denim*Jumpsuit)|(Futatabi6.5*Jumpsuit)|(Momohime*Jumpsuit)|(Sorahikohime*Jumpsuit)|(Charlotte5*Jumpsuit)",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62046220"
        },

        # Pants (Women/Unisex), Woven, Cotton 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62046290"
        },

        # Pants (Women/Unisex), Woven, Synthetic 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62046320"
        },

        # Pants (Women/Unisex), Woven, Artificial 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62046920"
        },

        # Pants (Women/Unisex), Woven, Other Material 
        {
            "product_digit": "6",
            "knit_woven": "Woven",
            "product_type_includes": r"Overall|Jumpsuit",
            "product_type_excludes": None,
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62046990"
        },            
        
        # ─────────────────────────────────────────────────────────────────────
        # 7 - CUT & SWEN TOP RULES
        # ─────────────────────────────────────────────────────────────────────

        # ─────────────────────────────────────────────────────────────────────
        # 7.1.1 - CUT & SWEN - KNIT - T-SHIRT
        # ─────────────────────────────────────────────────────────────────────

        # T-shirt (Men/Women/Unisex), Knit, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": None,
            "material_bucket": "Cotton",
            "hs_code": "61091010"
        },         
        
        # T-shirt (Men/Women/Unisex), Knit, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": None,
            "material_bucket": "Man-made",
            "hs_code": "61099010"
        },    

        # T-shirt (Men/Women/Unisex), Knit, Silk
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": None,
            "material_bucket": "Silk",
            "hs_code": "61099040"
        },    

        # T-shirt (Men/Women/Unisex), Knit, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": None,
            "material_bucket": "Other Material",
            "hs_code": "61099051"
        }, 

        # ─────────────────────────────────────────────────────────────────────
        # 7.1.2 - CUT & SWEN - KNIT - SLEEVELESS
        # ─────────────────────────────────────────────────────────────────────
        
        # Sleeveless (Men), Knit, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61091020"
        },     
        
        # Sleeveless (Men), Knit, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "61099020"
        },     

        # Sleeveless (Men), Knit, Silk
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "61099040"
        },     

        # Sleeveless (Men), Knit, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "61099052"
        },     

        # Sleeveless (Women/Unisex), Knit, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61091030"
        },     
        
        # Sleeveless (Women/Unisex), Knit, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "61099030"
        },     

        # Sleeveless (Women/Unisex), Knit, Silk
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61099040"
        },     

        # Sleeveless (Women/Unisex), Knit, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61099053"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 7.1.3 - CUT & SWEN - KNIT - PULLOVER
        # ─────────────────────────────────────────────────────────────────────

        # Pullover (Men), Knit, Wool
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61101110"
        },     

        # Pullover (Men), Knit, Cashmere
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Cashmere",
            "hs_code": "61101210"
        },     

        # Pullover (Men), Knit, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61102010"
        },     

        # Pullover (Men), Knit, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "61103010"
        },    
        
        # Pullover (Men), Knit, Silk
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "61109010"
        },     

        # Pullover (Men), Knit, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "61109080"
        },     

        # Pullover (Women/Unisex), Knit, Wool
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61101120"
        },     

        # Pullover (Women/Unisex), Knit, Cashmere
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Cashmere",
            "hs_code": "61101220"
        },     

        # Pullover (Women/Unisex), Knit, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61102020"
        },     

        # Pullover (Women/Unisex), Knit, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "61103020"
        },    
        
        # Pullover (Women/Unisex), Knit, Silk
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61109020"
        },     

        # Pullover (Women/Unisex), Knit, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61109090"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 7.1.4 - CUT & SWEN - KNIT - DRESS
        # ─────────────────────────────────────────────────────────────────────

        # Dress (Women/Unisex), Knit, Wool
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61044100"
        },     

        # Dress (Women/Unisex), Knit, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61044200"
        },     

        # Dress (Women/Unisex), Knit, Synthetic
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61044300"
        },   
        
        # Dress (Women/Unisex), Knit, Artificial
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61044400"
        },     

        # Dress (Women/Unisex), Knit, Silk
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61044910"
        },     

        # Dress (Women/Unisex), Knit, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61044990"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 7.2.1 - CUT & SWEN - WOVEN - T-SHIRT
        # ─────────────────────────────────────────────────────────────────────

        # T-shirt (Men), Woven, Wool
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62059030"
        },    

        # Denim T-shirt (Men), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"(Denim*T-shirt)|(Denim*Polo)|(Denim*Grandpa)",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62052010"
        },    

        # T-shirt (Men), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62052020"
        },    

        # T-shirt (Men), Woven, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "62053010"
        },    

        # T-shirt (Men), Woven, Silk
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62059010"
        },    

        # T-shirt (Men), Woven, Other Material 
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "62059080"
        },   
        
        # T-shirt (Women/Unisex), Woven, Wool
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62062010"
        },     

        # T-shirt (Women/Unisex), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62063010"
        },    

        # T-shirt (Women/Unisex), Woven, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "62064010"
        },    

        # T-shirt (Women/Unisex), Woven, Silk
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62061010"
        },    

        # T-shirt (Women/Unisex), Woven, Other Material 
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"T-shirt|Polo|Grandpa",
            "product_type_excludes": r"Sleeveless|Inner|Camisole|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62069010"
        },   

        # ─────────────────────────────────────────────────────────────────────
        # 7.2.2 - CUT & SWEN - WOVEN - SLEEVELESS
        # ─────────────────────────────────────────────────────────────────────
        
        # Sleeveless (Men), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62079110"
        },     
        
        # Sleeveless (Men), Woven, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "62079940"
        },     

        # Sleeveless (Men), Woven, Silk
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62079930"
        },     

        # Sleeveless (Men), Woven, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "62079991"
        },     

        # Sleeveless (Women/Unisex), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62089110"
        },     
        
        # Sleeveless (Women/Unisex), Woven, Man-made
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "62089930"
        },     

        # Sleeveless (Women/Unisex), Woven, Silk
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62089210"
        },     

        # Sleeveless (Women/Unisex), Woven, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Inner|Camisole|Sleeveless",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|Dress",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62089991"
        },     
        
        # ─────────────────────────────────────────────────────────────────────
        # 7.2.3 - CUT & SWEN - WOVEN - PULLOVER
        # ─────────────────────────────────────────────────────────────────────

        # Pullover (Men), Woven, Wool
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62033100"
        },     

        # Denim Pullover (Men), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"(Denim*Pullover)|(Denim*Hoodie)|(Denim*Cachecoeur)|(Denim*Cache-coeur)|(Denim*Sweat)|(Denim*Tunic)|(Denim*Cardigan)|(Denim*Umamock)|(Denim*Jacket)|(Denim*Sweatshirt)",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62033210"
        },     

        # Pullover (Men), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62033290"
        },     

        # Pullover (Men), Woven, Synthetic
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "62033300"
        },    


        # Pullover (Men), Woven, Artificial
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "62033910"
        },    
        
        # Pullover (Men), Woven, Silk
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62033920"
        },     

        # Pullover (Men), Woven, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "62033990"
        },     

        # Pullover (Women/Unisex), Woven, Wool
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62043100"
        },     

        # Denim Pullover (Women/Unisex), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"(Denim*Pullover)|(Denim*Hoodie)|(Denim*Cachecoeur)|(Denim*Cache-coeur)|(Denim*Sweat)|(Denim*Tunic)|(Denim*Cardigan)|(Denim*Umamock)|(Denim*Jacket)|(Denim*Sweatshirt)",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62043210"
        },        

        # Pullover (Women/Unisex), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62043290"
        },     

        # Pullover (Women/Unisex), Woven, Synthetic
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62043300"
        },    

        # Pullover (Women/Unisex), Woven, Artificial
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62043910"
        },    
        
        # Pullover (Women/Unisex), Woven, Silk
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62043920"
        },     

        # Pullover (Women/Unisex), Woven, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt",
            "product_type_excludes": r"T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless|Dress",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62043990"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 7.2.4 - CUT & SWEN - WOVEN - DRESS
        # ─────────────────────────────────────────────────────────────────────

        # Dress (Women/Unisex), Woven, Wool
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Dress",
            "product_type_excludes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62044100"
        },     

        # Denim Dress (Women/Unisex), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"(Denim*Dress)",
            "product_type_excludes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62044210"
        },        

        # Dress (Women/Unisex), Woven, Cotton
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Dress",
            "product_type_excludes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62044290"
        },     

        # Dress (Women/Unisex), Woven, Synthetic
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Dress",
            "product_type_excludes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62044300"
        },    

        # Dress (Women/Unisex), Woven, Artificial
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Dress",
            "product_type_excludes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62044400"
        },    
        
        # Dress (Women/Unisex), Woven, Silk
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Dress",
            "product_type_excludes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62044910"
        },     

        # Dress (Women/Unisex), Woven, Other Material
        {
            "product_digit": "7",
            "knit_woven": "Woven",
            "product_type_includes": r"Dress",
            "product_type_excludes": r"Pullover|Hoodie|Cachecoeur|Cache-coeur|Sweat|Tunic|Cardigan|Umamock|Jacket|Sweatshirt|T-shirt|Polo|Grandpa|Inner|Camisole|Sleeveless",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62044990"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 8 - KNIT TOP RULES
        # ─────────────────────────────────────────────────────────────────────

        # ─────────────────────────────────────────────────────────────────────
        # 8.1.1 - KNIT - KNIT - PULLOVER
        # ─────────────────────────────────────────────────────────────────────

        # Pullover (Men), Knit, Wool
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Poncho",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61101110"
        },     

        # Pullover (Men), Knit, Cashmere
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Poncho",
            "gender_class": "M",
            "material_bucket": "Cashmere",
            "hs_code": "61101210"
        },     

        # Pullover (Men), Knit, Cotton
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61102010"
        },     

        # Pullover (Men), Knit, Man-made
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Poncho",
            "gender_class": "M",
            "material_bucket": "Man-made",
            "hs_code": "61103010"
        },     

        # Pullover (Men), Knit, Silk
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "61109010"
        },     

        # Pullover (Men), Knit, Other Material
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "61109080"
        },  
        
        # Pullover (Women/Unisex), Knit, Wool
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61101120"
        },    

        # Pullover (Women/Unisex), Knit, Cashmere
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "W",
            "material_bucket": "Cashmere",
            "hs_code": "61101220"
        },    

        # Pullover (Women/Unisex), Knit, Cotton
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61102020"
        },     

        # Pullover (Women/Unisex), Knit, Man-made
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "W",
            "material_bucket": "Man-made",
            "hs_code": "61103020"
        },     

        # Pullover (Women/Unisex), Knit, Silk
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "61109020"
        },     

        # Pullover (Women/Unisex), Knit, Other Material
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Muffler|Cap|Hat|Poncho",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61109090"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 8.1.2 - KNIT - KNIT - T-SHIRT
        # ─────────────────────────────────────────────────────────────────────

        # T-shirt (Men/Women/Unisex), Knit, Cotton
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"T-shirt|Polo|Shirt|Tunic",
            "product_type_excludes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat|Poncho",
            "gender_class": None,
            "material_bucket": "Cotton",
            "hs_code": "61091010"
        },     

        # T-shirt (Men/Women/Unisex), Knit, Man-made
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"T-shirt|Polo|Shirt|Tunic",
            "product_type_excludes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat|Poncho",
            "gender_class": None,
            "material_bucket": "Man-made",
            "hs_code": "61099010"
        },  
        
        # T-shirt (Men/Women/Unisex), Knit, Silk
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"T-shirt|Polo|Shirt|Tunic",
            "product_type_excludes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat|Poncho",
            "gender_class": None,
            "material_bucket": "Silk",
            "hs_code": "61099040"
        },   

        # T-shirt (Men/Women/Unisex), Knit, Other Material
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"T-shirt|Polo|Shirt|Tunic",
            "product_type_excludes": r"Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat|Poncho",
            "gender_class": None,
            "material_bucket": "Other Material",
            "hs_code": "61099051"
        },   

        # ─────────────────────────────────────────────────────────────────────
        # 8.1.3 - KNIT - KNIT - MUFFLER
        # ─────────────────────────────────────────────────────────────────────

        # Muffler (Men/Women/Unisex), Knit, Wool
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Muffler",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Cap|Hat|Poncho",
            "gender_class": None,
            "material_bucket": "Wool",
            "hs_code": "61171020"
        },     

        # Muffler (Men/Women/Unisex), Knit, Cashmere
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Muffler",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Cap|Hat|Poncho",
            "gender_class": None,
            "material_bucket": "Cashmere",
            "hs_code": "61171019"
        },     

        # Muffler (Men/Women/Unisex), Knit, Other Material
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Muffler",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Cap|Hat|Poncho",
            "gender_class": None,
            "material_bucket": "Other Material",
            "hs_code": "61171090"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 8.1.4 - KNIT - KNIT - CAP
        # ─────────────────────────────────────────────────────────────────────

        # Cap (Men/Women/Unisex), Knit, Wool
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Cap|Hat",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Poncho",
            "gender_class": None,
            "material_bucket": "Wool",
            "hs_code": "65050030"
        },     

        # Cap (Men/Women/Unisex), Knit, Cotton
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Cap|Hat",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Poncho",
            "gender_class": None,
            "material_bucket": "Cotton",
            "hs_code": "65050020"
        },     

        # Cap (Men/Women/Unisex), Knit, Other Material
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Cap|Hat",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Poncho",
            "gender_class": None,
            "material_bucket": "Other Material",
            "hs_code": "65050090"
        },    

        # ─────────────────────────────────────────────────────────────────────
        # 8.1.5 - KNIT - KNIT - PONCHO
        # ─────────────────────────────────────────────────────────────────────
        
        # Poncho (Men), Knit, Wool
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61033100"
        },
        
        # Poncho (Men), Knit, Cotton
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61033200"
        },

        # Poncho (Men), Knit, Synthetic
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "61033300"
        },

        # Poncho (Men), Knit, Artificial
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "61033910"
        },

        # Poncho (Men), Knit, Other Material
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "61033990"
        },
        
        # Poncho (Women/Unisex), Knit, Wool
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61033100"
        },
        
        # Poncho (Women/Unisex), Knit, Cotton
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61033200"
        },

        # Poncho (Women/Unisex), Knit, Synthetic
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61033300"
        },

        # Poncho (Women/Unisex), Knit, Artificial
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61033910"
        },

        # Poncho (Women/Unisex), Knit, Other Material
        {
            "product_digit": "8",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"T-shirt|Polo|Shirt|Tunic|Pullover|Crewneck|Cachecoeur|Cache-coeur|Jacket|Turtleneck|Blouson|Bolero|Cardigan|Kamue|Yockneck|Hoodie|Henley|Sweater|Vest|Camisole|Coverall|Top|Muffler|Cap|Hat",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61033990"
        },
        
        # ─────────────────────────────────────────────────────────────────────
        # 9 - ACCESSORIES RULES
        # ─────────────────────────────────────────────────────────────────────
        
        # ─────────────────────────────────────────────────────────────────────
        # 9.1.1 - ACCESSORIES - KNIT - SCARF
        # ─────────────────────────────────────────────────────────────────────

        # Scarf (Men/Women/Unisex), Knit, Wool
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Wool",
            "hs_code": "61171020"
        },     

        # Muffler (Men/Women/Unisex), Knit, Cashmere
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Cashmere",
            "hs_code": "61171019"
        },     

        # Muffler (Men/Women/Unisex), Knit, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "61171090"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 9.1.2 - ACCESSORIES - KNIT - BELT
        # ─────────────────────────────────────────────────────────────────────

        # Belt (Men/Women/Unisex), Knit, Any Material
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Belt",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "61178010"
        },    

        # ─────────────────────────────────────────────────────────────────────
        # 9.1.3 - ACCESSORIES - KNIT - TIE
        # ─────────────────────────────────────────────────────────────────────

        # Tie (Men/Women/Unisex), Knit, Any Material
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Tie",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "61178020"
        },    

        # ─────────────────────────────────────────────────────────────────────
        # 9.1.4 - ACCESSORIES - KNIT - OTHER
        # ─────────────────────────────────────────────────────────────────────

        # Tie (Men/Women/Unisex), Knit, Any Material
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Ribbon|Hair Band|Hairband|Bandana",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Sox|Sock|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "61178020"
        },    

        # ─────────────────────────────────────────────────────────────────────
        # 9.1.5 - ACCESSORIES - KNIT - SOX
        # ─────────────────────────────────────────────────────────────────────
       
        # Sox (Men), Knit, Wool
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61159410"
        },
        
        # Sox (Men), Knit, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61159510"
        },   
        
        # Sox (Men), Knit, Synthetic
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "61159610"
        },  

        # Sox (Men), Knit, Artificial
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "61159910"
        },  

        # Sox (Men), Knit, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": None,
            "hs_code": "61159980"
        },    

        # Sox (Women/Unisex), Knit, Wool
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61159420"
        },
        
        # Sox (Women/Unisex), Knit, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61159520"
        },   
        
        # Sox (Women/Unisex), Knit, Synthetic
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61159620"
        },  

        # Sox (Women/Unisex), Knit, Artificial
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61159920"
        },  

        # Sox (Women/Unisex), Knit, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": None,
            "hs_code": "61159990"
        },    

        # ─────────────────────────────────────────────────────────────────────
        # 9.1.6 - ACCESSORIES - KNIT - PONCHO
        # ─────────────────────────────────────────────────────────────────────

        # Poncho (Men), Knit, Wool
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "61033100"
        },
        
        # Poncho (Men), Knit, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "61033200"
        },

        # Poncho (Men), Knit, Synthetic
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "61033300"
        },

        # Poncho (Men), Knit, Artificial
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "61033910"
        },

        # Poncho (Men), Knit, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "61033990"
        },
        
        # Poncho (Women/Unisex), Knit, Wool
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "61033100"
        },
        
        # Poncho (Women/Unisex), Knit, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "61033200"
        },

        # Poncho (Women/Unisex), Knit, Synthetic
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "61033300"
        },

        # Poncho (Women/Unisex), Knit, Artificial
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "61033910"
        },

        # Poncho (Women/Unisex), Knit, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Knit",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "61033990"
        },

        # ─────────────────────────────────────────────────────────────────────
        # 9.2.1 - ACCESSORIES - WOVEN - SCARF
        # ─────────────────────────────────────────────────────────────────────

        # Scarf (Men/Women/Unisex), Woven, Wool
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Wool",
            "hs_code": "62142010"
        },     

        # Muffler (Men/Women/Unisex), Woven, Cashmere
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Cashmere",
            "hs_code": "62142020"
        },    
        
        # Muffler (Men/Women/Unisex), Woven, Synthetic
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Synthetic",
            "hs_code": "62143000"
        },  
        
        # Muffler (Men/Women/Unisex), Woven, Artificial
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Synthetic",
            "hs_code": "62144000"
        },  

        # Muffler (Men/Women/Unisex), Woven, Silk
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Silk",
            "hs_code": "62141000"
        },  

        # Muffler (Men/Women/Unisex), Woven, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"FUROSHIKii|Muffler|Stole",
            "product_type_excludes": r"Belt|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "62149000"
        },     

        # ─────────────────────────────────────────────────────────────────────
        # 9.2.2 - ACCESSORIES - WOVEN - BELT
        # ─────────────────────────────────────────────────────────────────────

        # Belt (Men/Women/Unisex), Woven, Any Material
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Belt",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Tie|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "62171050"
        },    

        # ─────────────────────────────────────────────────────────────────────
        # 9.2.3 - ACCESSORIES - WOVEN - TIE
        # ─────────────────────────────────────────────────────────────────────

        # Tie (Men/Women/Unisex), Woven, Man-made
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Tie",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Man-made",
            "hs_code": "62152000"
        },    

        # Tie (Men/Women/Unisex), Woven, Silk
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Tie",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Silk",
            "hs_code": "62151000"
        },    

        # Tie (Men/Women/Unisex), Woven, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Tie",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Bandana|Sox|Sock|Poncho|Hat|Cap|Ribbon|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag|Hair Band|Hairband",
            "gender_class": None,
            "material_bucket": "Other Material",
            "hs_code": "62159000"
        },    

        # ─────────────────────────────────────────────────────────────────────
        # 9.2.4 - ACCESSORIES - WOVEN - SOX
        # ─────────────────────────────────────────────────────────────────────

        # Sox (Men/Women/Unisex), Woven, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62171010"
        },   

        # Sox (Men/Women/Unisex), Woven, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Sox|Sock",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62171020"
        },   

        # ─────────────────────────────────────────────────────────────────────
        # 9.2.5 - ACCESSORIES - WOVEN - BANDANA
        # ─────────────────────────────────────────────────────────────────────
        
        # Bandana (Men/Women/Unisex), Woven, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Bandana",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Sox|Sock|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62132010"
        },   

        # Bandana (Men/Women/Unisex), Woven, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Bandana",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Sox|Sock|Poncho|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62139010"
        },   

        # ─────────────────────────────────────────────────────────────────────
        # 9.2.6 - ACCESSORIES - WOVEN - PONCHO
        # ─────────────────────────────────────────────────────────────────────

        # Poncho (Men), Woven, Wool
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Wool",
            "hs_code": "62033100"
        },

        # Denim Poncho (Men), Woven, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"(Denim*Poncho)",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62033210"
        },
        
        # Poncho (Men), Woven, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Cotton",
            "hs_code": "62033290"
        },

        # Poncho (Men), Woven, Synthetic
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Synthetic",
            "hs_code": "62033300"
        },

        # Poncho (Men), Woven, Artificial
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Artificial",
            "hs_code": "62033910"
        },

        # Poncho (Men), Woven, Silk
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Silk",
            "hs_code": "62033920"
        },

        # Poncho (Men), Woven, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "M",
            "material_bucket": "Other Material",
            "hs_code": "62033990"
        },
        
        # Poncho (Women/Unisex), Woven, Wool
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Wool",
            "hs_code": "62043100"
        },

        # Denim Poncho (Women/Unisex), Woven, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"(Demin*Poncho)",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62043210"
        },
        
        # Poncho (Women/Unisex), Woven, Cotton
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Cotton",
            "hs_code": "62043290"
        },

        # Poncho (Women/Unisex), Woven, Synthetic
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Synthetic",
            "hs_code": "62043300"
        },

        # Poncho (Women/Unisex), Woven, Artificial
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Artificial",
            "hs_code": "62043910"
        },

        # Poncho (Women/Unisex), Woven, Silk
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Silk",
            "hs_code": "62043920"
        },

        # Poncho (Women/Unisex), Woven, Other Material
        {
            "product_digit": "9",
            "knit_woven": "Woven",
            "product_type_includes": r"Poncho",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Hat|Cap|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": "W",
            "material_bucket": "Other Material",
            "hs_code": "62043990"
        },

        # ─────────────────────────────────────────────────────────────────────
        # 9.3 - ACCESSORIES - HAT 
        # ─────────────────────────────────────────────────────────────────────

        # Cap (Men/Women/Unisex), Wool
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Cap|Hat",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": None,
            "material_bucket": "Wool",
            "hs_code": "65050030"
        },     

        # Cap (Men/Women/Unisex), Cotton
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Cap|Hat",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": None,
            "material_bucket": "Cotton",
            "hs_code": "65050020"
        },     

        # Cap (Men/Women/Unisex), Other Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Cap|Hat",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": None,
            "material_bucket": "Other Material",
            "hs_code": "65050090"
        },    

        # ─────────────────────────────────────────────────────────────────────
        # 9.4 - ACCESSORIES - SHOE 
        # ─────────────────────────────────────────────────────────────────────

        # Shoe (Men/Women/Unisex), Textile Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Shoe|Sneaker",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Ribbon|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "64041900"
        },  

        # ─────────────────────────────────────────────────────────────────────
        # 9.5 - ACCESSORIES - RIBBON 
        # ─────────────────────────────────────────────────────────────────────

        # Ribbon (Men/Women/Unisex), Any Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Ribbon",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Choker|Necklace|Earrings|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "50079000"
        },  

        # ─────────────────────────────────────────────────────────────────────
        # 9.6 - ACCESSORIES - JEWELLERY 
        # ─────────────────────────────────────────────────────────────────────

        # Jewellery (Men/Women/Unisex), Any Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Choker|Necklace|Earrings|Bracelet",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Ribbon|Bracelet|Key Holder|Keyring|Bag",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "71179000"
        },  

        # ─────────────────────────────────────────────────────────────────────
        # 9.7 - ACCESSORIES - KEY HOLDER 
        # ─────────────────────────────────────────────────────────────────────

        # Key holder (Men/Women/Unisex), Any Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Key Holder|Keyring",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Ribbon|Bracelet|Choker|Necklace|Earrings|Bracelet|Bag",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "71171900"
        },   

        # ─────────────────────────────────────────────────────────────────────
        # 9.8 - ACCESSORIES - BOOK
        # ─────────────────────────────────────────────────────────────────────

        # Book (Men/Women/Unisex), Any Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Book|Catalog|Calendar",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Ribbon|Bracelet|Choker|Necklace|Earrings|Bracelet|Bag|Key Holder|Keyring",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "49019900"
        },   

        # ─────────────────────────────────────────────────────────────────────
        # 9.9 - ACCESSORIES - BAG
        # ─────────────────────────────────────────────────────────────────────

        # Bag (Men/Women/Unisex), Any Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Bag|Tote",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Ribbon|Bracelet|Choker|Necklace|Earrings|Bracelet|Book|Catalog|Calendar|Key Holder|Keyring",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "42029260"
        },   

        # ─────────────────────────────────────────────────────────────────────
        # 9.10 - ACCESSORIES - NAVACCO
        # ─────────────────────────────────────────────────────────────────────

        # NAVACCO (Men/Women/Unisex), Any Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"NAVACCO",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Belt|Tie|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Ribbon|Bracelet|Choker|Necklace|Earrings|Bracelet|Book|Catalog|Calendar|Key Holder|Keyring|Bag|Tote",
            "gender_class": None,
            "material_bucket": None,
            "hs_code": "95030040"
        },   

        # ─────────────────────────────────────────────────────────────────────
        # 9.11 - ACCESSORIES - BELT
        # ─────────────────────────────────────────────────────────────────────

        # Belt (Men/Women/Unisex), Any Material
        {
            "product_digit": "9",
            "knit_woven": None,
            "product_type_includes": r"Belt",
            "product_type_excludes": r"FUROSHIKii|Muffler|Stole|Tie|Hair Band|Hairband|Bandana|Sox|Sock|Poncho|Ribbon|Bracelet|Choker|Necklace|Earrings|Bracelet|Book|Catalog|Calendar|Key Holder|Keyring|Bag|Tote",
            "gender_class": None,
            "material_bucket": "Leather",
            "hs_code": "42033010"
        }, 
        ]
    
        # ─────────────────────────────────────────────────────────────
        # MATERIAL MAPPING
        # ─────────────────────────────────────────────────────────────
        MATERIAL_BUCKETS = {
            'ウール': 'Wool', '毛': 'Wool', 'アルパカ': 'Wool',
            'カシミヤ': 'Cashmere', 'カシミア': 'Cashmere',
            'コットン': 'Cotton', '綿': 'Cotton',
            'ポリクラール': 'Synthetic', 'ポリエステル': 'Synthetic', 'ナイロン': 'Synthetic',
            'アクリル': 'Synthetic', '合成繊維': 'Synthetic',
            'レーヨン': 'Artificial', 'RAYON': 'Artificial', 'VISCOSE': 'Artificial', 'ARTIFICIAL': 'Artificial',
            'シルク': 'Silk', '絹': 'Silk',
            'DENIM': 'Denim', 'デニム': 'Denim',
            'LEATHER': 'Leather', 'レザー': 'Leather',
        }
    
        # ─────────────────────────────────────────────────────────────
        # Helpers (data)
        # ─────────────────────────────────────────────────────────────
        def normalize_material(material_text):
            if pd.isna(material_text):
                return "Any"
            material_str = str(material_text).upper().strip()
            for keyword, bucket in MATERIAL_BUCKETS.items():
                if keyword in material_str:
                    return bucket
            return "Other"
    
        def get_product_digit(hinban):
            if pd.isna(hinban):
                return None
            s = str(hinban).strip()
            return s[3] if len(s) >= 4 else None
    
        def classify_gender(gender_val):
            val = str(gender_val).strip()
            if val in ["Unisex", "レディース"]:
                return "W"
            elif val == "メンズ":
                return "M"
            return "W"  # default
    
        def classify_knit_woven(val):
            if pd.isna(val):
                return "/"
            v = str(val).strip()
            if v == "K":
                return "Knit"
            if v == "W":
                return "Woven"
            return "/"
    
        def infer_knit_woven(row):
            try:
                if "Knit / Woven" in row.index and not pd.isna(row["Knit / Woven"]):
                    return classify_knit_woven(row["Knit / Woven"])
            except:
                pass
            item = str(row.get("アイテム", "") if hasattr(row, 'get') else "").lower()
            product_name = str(row.get("品名", "") if hasattr(row, 'get') else "").lower()
            item_desc = str(row.get("Item Description", "") if hasattr(row, 'get') else "").lower()
            combined = f"{item} {product_name} {item_desc}"
            if any(k in combined for k in ["denim", "デニム", "ﾃﾞﾆﾑ", "pants", "パンツ", "shirt", "シャツ"]):
                return "Woven"
            if any(k in combined for k in ["knit", "ニット", "sweater", "cardigan", "カーディガン"]):
                return "Knit"
            return "/"
    
        def match_hs_code_rule(row):
            hinban = str(row.get("品番", "")).strip()
            product_digit = get_product_digit(hinban)
            knit_woven = infer_knit_woven(row)
            gender = classify_gender(row.get("性別", ""))
            material = normalize_material(row.get("素材1", ""))
            product_name_jp = str(row.get("品名", "")).strip()
            product_name_en = str(row.get("Item Description", "")).strip()
            product_type = f"{product_name_jp} {product_name_en}"
            for rule in HS_CODE_RULES:
                if rule.get("product_digit") and product_digit != rule["product_digit"]:
                    continue
                if rule.get("knit_woven") and knit_woven != rule["knit_woven"]:
                    continue
                if rule.get("gender_class") and gender != rule["gender_class"]:
                    continue
                if rule.get("material_bucket") and rule["material_bucket"] != "Any":
                    if material != rule["material_bucket"]:
                        continue
                if rule.get("product_type_includes"):
                    if not re.search(rule["product_type_includes"], product_type, re.IGNORECASE):
                        continue
                if rule.get("product_type_excludes"):
                    if re.search(rule["product_type_excludes"], product_type, re.IGNORECASE):
                        continue
                return rule["hs_code"]
            return "N/A"
    
        def safe_max_carton(df_raw):
            if "C/No." not in df_raw.columns:
                return None
            series = pd.to_numeric(df_raw["C/No."], errors="coerce")
            return int(series.max()) if series.notna().any() else None
    
        def country_key(s):
            mapping = {
                "日本": "JAPAN", "にほん": "JAPAN", "ニホン": "JAPAN", "Japan": "JAPAN", "JAPAN": "JAPAN",
                "中国": "CHINA", "China": "CHINA", "CHINA": "CHINA",
                "ベトナム": "VIETNAM", "Vietnam": "VIETNAM", "VIETNAM": "VIETNAM",
                "韓国": "KOREA", "Korea": "KOREA", "KOREA": "KOREA",
                "インド": "INDIA", "India": "INDIA", "INDIA": "INDIA",
                "台湾": "TAIWAN", "Taiwan": "TAIWAN", "TAIWAN": "TAIWAN",
                "香港": "HONG KONG", "Hong Kong": "HONG KONG", "HONG KONG": "HONG KONG",
            }
            s = (s or "").strip()
            return mapping.get(s, s.upper())
    
        # ─────────────────────────────────────────────────────────────
        # DOM helpers (single table, id="main-table")
        # ─────────────────────────────────────────────────────────────
        def get_main_table():
            return js.document.getElementById("main-table")
    
        def append_carton_rows_to_table(max_carton):
            if max_carton is None:
                return
            table = get_main_table()
            if not table:
                return
            col_count = 0
            if table.tHead and table.tHead.rows.length > 0:
                col_count = table.tHead.rows[0].cells.length
            if col_count == 0 and table.tBodies.length > 0 and table.tBodies[0].rows.length > 0:
                col_count = table.tBodies[0].rows[0].cells.length
            if col_count == 0:
                return
            tbody = table.tBodies[0] if table.tBodies.length > 0 else table
            def add_spacer():
                tr = js.document.createElement("tr")
                td = js.document.createElement("td")
                td.setAttribute("colspan", str(col_count))
                td.innerHTML = "&nbsp;"
                tr.appendChild(td)
                tbody.appendChild(tr)
            add_spacer(); add_spacer(); add_spacer()
            tr = js.document.createElement("tr")
            td = js.document.createElement("td")
            td.setAttribute("colspan", str(col_count))
            td.style.textAlign = "center"
            td.style.fontWeight = "600"
            td.textContent = f"{max_carton} Carton"
            tr.appendChild(td)
            tbody.appendChild(tr)
    
        def insert_country_headers(country_col_name="原産国"):
            table = get_main_table()
            if not table:
                return
            header_cells = table.tHead.rows[table.tHead.rows.length - 1].cells if (table.tHead and table.tHead.rows.length) else None
            if not header_cells:
                return
            # find 原産国 column index using the actual column header row (last row in THEAD)
            col_idx = -1
            for i in range(header_cells.length):
                if header_cells[i].textContent.strip() == country_col_name:
                    col_idx = i
                    break
            if col_idx == -1:
                return
            tbody = table.tBodies[0] if table.tBodies.length > 0 else table
            rows = list(tbody.rows)  # snapshot
            last_key = None
            for r in rows:
                cells = r.cells
                if col_idx >= cells.length:
                    continue
                raw_country = cells[col_idx].textContent.strip()
                k = country_key(raw_country)
                if k != last_key:
                    tr = js.document.createElement("tr")
                    td = js.document.createElement("td")
                    total_cols = header_cells.length
                    td.setAttribute("colspan", str(total_cols))
                    td.style.textAlign = "center"
                    td.style.fontWeight = "700"
                    td.style.background = "#f5f5f5"
                    td.textContent = f"MADE IN {k}" if k else "MADE IN —"
                    tr.appendChild(td)
                    tbody.insertBefore(tr, r)
                    last_key = k
    
        def hide_table_column(header_text):
            table = get_main_table()
            if not table or not (table.tHead and table.tHead.rows.length):
                return
            # find index from the actual header row (the last THEAD row)
            header_row = table.tHead.rows[table.tHead.rows.length - 1]
            idx = -1
            for i in range(header_row.cells.length):
                if header_row.cells[i].textContent.strip() == header_text:
                    idx = i
                    break
            if idx == -1:
                return
            # hide in ALL thead rows (including the 14 pre-header rows)
            for r in table.tHead.rows:
                if idx < r.cells.length:
                    r.cells[idx].style.display = "none"
            # hide all body cells in that column
            if table.tBodies.length:
                for r in table.tBodies[0].rows:
                    if idx < r.cells.length:
                        r.cells[idx].style.display = "none"
    
        # ─────────────────────────────────────────────────────────────
        # NEW: insert the 14 pre-header rows INSIDE thead (same table)
        # ─────────────────────────────────────────────────────────────
        def insert_preheader_rows_into_thead(rows_specs,
                                            left_header_candidates=("Style No.", "品番"),
                                            right_header_candidates=("Description of Good", "Item Description")):
            """
            Insert N rows above the actual column header row, inside <thead> of #main-table.
            Order is preserved: the FIRST item in rows_specs appears at the VERY TOP.
            """
            table = get_main_table()
            if not table or not (table.tHead and table.tHead.rows.length):
                return
            thead = table.tHead
            actual_header_row = thead.rows[thead.rows.length - 1]  # original column names row
            col_count = actual_header_row.cells.length

            def resolve_idx(candidates):
                for i in range(col_count):
                    name = actual_header_row.cells[i].textContent.strip()
                    for cand in candidates:
                        if name == cand:
                            return i
                return -1

            left_idx  = resolve_idx(left_header_candidates)
            right_idx = resolve_idx(right_header_candidates)
            if left_idx == -1:  left_idx = 0
            if right_idx == -1: right_idx = min(1, col_count-1)

            target = rows_specs[:]
            while len(target) < 14:
                target.append({"left": "", "right": ""})

            # IMPORTANT: iterate in forward order so the first spec goes to the very top
            for spec in target:
                tr = js.document.createElement("tr")
                for _ in range(col_count):
                    th = js.document.createElement("th")
                    th.style.fontWeight = "400"
                    th.style.padding = "2px 6px"
                    th.style.border = "none"
                    th.textContent = ""
                    tr.appendChild(th)
                if "left" in spec and spec["left"] is not None:
                    tr.cells[left_idx].textContent = str(spec["left"])
                    tr.cells[left_idx].style.fontWeight = "600"
                if "right" in spec and spec["right"] is not None:
                    tr.cells[right_idx].textContent = str(spec["right"])
                    tr.cells[right_idx].style.fontWeight = "600"
                thead.insertBefore(tr, actual_header_row)

    
        # Insert a custom row directly under the header (in tbody)
        def insert_row_under_header(col_name_left, text_left, col_name_right, text_right):
            table = get_main_table()
            if not table or not (table.tHead and table.tBodies.length):
                return
            thead = table.tHead
            tbody = table.tBodies[0]
            # find indices from the actual header row (last thead row)
            header_row = thead.rows[thead.rows.length - 1]
            col_idx_left = -1
            col_idx_right = -1
            col_count = header_row.cells.length
            for i in range(col_count):
                name = header_row.cells[i].textContent.strip()
                if name == col_name_left:  col_idx_left = i
                if name == col_name_right: col_idx_right = i
            tr = js.document.createElement("tr")
            for _ in range(col_count):
                tr.appendChild(js.document.createElement("td"))
            if col_idx_left >= 0:
                tr.cells[col_idx_left].textContent = text_left
                tr.cells[col_idx_left].style.fontWeight = "600"
            if col_idx_right >= 0:
                tr.cells[col_idx_right].textContent = text_right
                tr.cells[col_idx_right].style.fontWeight = "600"
                tr.cells[col_idx_right].style.textAlign = "right"
            tbody.insertBefore(tr, tbody.firstChild)
    
        # Append totals row at end of data (in tbody)
        def append_totals_row(first_cell_text, qty_col_name, amount_col_name, total_qty, total_amount_str):
            table = get_main_table()
            if not table or not (table.tHead and table.tBodies.length):
                return
            thead = table.tHead
            tbody = table.tBodies[0]
            header_row = thead.rows[thead.rows.length - 1]
            col_count = header_row.cells.length
    
            qty_idx = -1
            amount_idx = -1
            for i in range(col_count):
                name = header_row.cells[i].textContent.strip()
                if name == qty_col_name:    qty_idx = i
                if name == amount_col_name: amount_idx = i
    
            tr = js.document.createElement("tr")
            for _ in range(col_count):
                td = js.document.createElement("td")
                tr.appendChild(td)
    
            tr.cells[0].textContent = first_cell_text
            tr.cells[0].style.fontWeight = "700"
    
            if qty_idx >= 0 and total_qty is not None:
                tr.cells[qty_idx].textContent = str(int(total_qty))
                tr.cells[qty_idx].style.textAlign = "right"
                tr.cells[qty_idx].style.fontWeight = "700"
            if amount_idx >= 0 and total_amount_str:
                tr.cells[amount_idx].textContent = total_amount_str
                tr.cells[amount_idx].style.textAlign = "right"
                tr.cells[amount_idx].style.fontWeight = "700"
    
            tr.style.borderTop = "2px solid #000"
            tbody.appendChild(tr)


            
    
        def setup_preheader_widgets():
            """
            Injects:
              - Row 1, col '上代/Unit Price'       -> <input type=date id=pre_date_1>
              - Row 3, col '上代/Unit Price'       -> <input type=text id=pre_invoice_no>
              - Row 10, col 'Item Description/Description of Good' -> <input type=date id=pre_date_2>
            And wires pre_date_1 -> pre_invoice_no formatter (YYMM).
            """
            table = get_main_table()
            if not table or not (table.tHead and table.tHead.rows.length >= 15 and table.tBodies.length):
                return
        
            thead = table.tHead
            header_row = thead.rows[thead.rows.length - 1]  # actual column header
            col_count = header_row.cells.length
        
            # Resolve column indices
            def find_idx(cands):
                for i in range(col_count):
                    name = header_row.cells[i].textContent.strip()
                    for c in cands:
                        if name == c:
                            return i
                return -1
        
            idx_unit = find_idx(("上代", "Unit Price"))
            idx_desc = find_idx(("Item Description", "Description of Good"))
            if idx_unit == -1: idx_unit = 0
            if idx_desc == -1: idx_desc = min(1, col_count-1)
        
            # Pre-header rows are 0..13; original header is last
            row1  = thead.rows[0]   # 1st
            row3  = thead.rows[2]   # 3rd
            row10 = thead.rows[9]   # 10th
        
            # --- Date #1 (row 1, above 上代/Unit Price)
            date1 = js.document.createElement("input")
            date1.type = "date"
            date1.id = "pre_date_1"
            date1.style.width = "100%"
            row1.cells[idx_unit].innerHTML = ""  # clear any text there
            row1.cells[idx_unit].appendChild(date1)
        
            # --- Invoice No. input (row 3, above 上代/Unit Price)
            inv = js.document.createElement("input")
            inv.type = "text"
            inv.id = "pre_invoice_no"
            inv.placeholder = "INVOICE NO.  RPM/EC/YYMM/"
            inv.style.width = "100%"
            row3.cells[idx_unit].innerHTML = ""
            row3.cells[idx_unit].appendChild(inv)
        
            # --- Date #2 (row 10, above Item Description)
            date2 = js.document.createElement("input")
            date2.type = "date"
            date2.id = "pre_date_2"
            date2.style.width = "100%"
            row10.cells[idx_desc].innerHTML = ""
            row10.cells[idx_desc].appendChild(date2)
        
            # --- Wiring: when Date #1 changes, format invoice default as "INVOICE NO.  RPM/EC/YYMM/"
            PREFIX = "INVOICE NO.  RPM/EC/"
        
            def on_date1_change(evt):
                try:
                    val = date1.value  # "YYYY-MM-DD" or ""
                    if not val:
                        return
                    parts = val.split("-")
                    if len(parts) < 2:  # safety
                        return
                    yy = parts[0][-2:]
                    mm = parts[1].zfill(2)
                    yymm = yy + mm
        
                    current = inv.value or ""
                    # Preserve anything typed AFTER the first "PREFIX + 4digits + /"
                    # e.g. "INVOICE NO.  RPM/EC/2509/ABC-01" -> suffix = "ABC-01"
                    suffix = ""
                    m = re.search(r'^' + re.escape(PREFIX) + r'(\d{4})/(.*)$', current)
                    if m:
                        suffix = m.group(2)
                    elif current.startswith(PREFIX):
                        # Has prefix but not our expected pattern; keep what's after prefix
                        suffix = current[len(PREFIX):]
                        # drop leading yymm/ if present
                        m2 = re.match(r'^\d{4}/(.*)$', suffix)
                        if m2:
                            suffix = m2.group(1)
        
                    inv.value = f"{PREFIX}{yymm}/" + (suffix or "")
                except Exception:
                    # don't break UI if anything odd happens
                    pass
        
            # attach listener
            js.document.getElementById("pre_date_1").addEventListener("change", create_proxy(on_date1_change))
        

        # ─────────────────────────────────────────────────────────────
        # Post-Total Interactive Goods Section (updated)
        # ─────────────────────────────────────────────────────────────
        HS_GOODS_MAP = {
            "Catalog": "49019900",
            "Calendar": "49100000",
            "Tote Bag": "42029260",
            "Cotton Materials": "52093900",  # adjust if needed
            "Gift Box": "48191000",
            "Red Pocket": "48171000",
        }
        GOODS_OPTIONS = ["", "Catalog", "Calendar", "Tote Bag", "Cotton Materials", "Gift Box", "Red Pocket"]
        
        def _find_idx_by_names(header_row, names):
            col_count = header_row.cells.length
            for i in range(col_count):
                txt = header_row.cells[i].textContent.strip()
                for name in names:
                    if txt == name:
                        return i
            return -1
        
        def _format_jpy(n):
            try:
                iv = int(round(float(n)))
                return "JPY " + f"{iv:,}"
            except:
                return ""
        
        def _parse_num(v):
            try:
                s = str(v).replace(",", "").strip()
                if s.upper().startswith("JPY"):
                    s = s[3:].strip()
                return float(s or "0")
            except:
                return 0.0
        
        def build_dynamic_goods_section():
            table = get_main_table()
            if not table or not (table.tHead and table.tBodies.length):
                return
        
            thead = table.tHead
            tbody = table.tBodies[0]
            header_row = thead.rows[thead.rows.length - 1]
            col_count = header_row.cells.length
        
            # Track any header columns that are hidden (e.g., 原産国) so new rows match
            hidden_idx = set(
                i for i in range(col_count)
                if (header_row.cells[i].style.display or "").lower() == "none"
            )
        
            def apply_hidden_cells(tr):
                for i in hidden_idx:
                    if i < tr.cells.length:
                        tr.cells[i].style.display = "none"
        
            # Resolve indices (JP/EN)
            idx_style = _find_idx_by_names(header_row, ("Style No.", "品番"))
            idx_desc  = _find_idx_by_names(header_row, ("Item Description", "Description of Good"))
            idx_hs    = _find_idx_by_names(header_row, ("HSコード", "Harmonized Tariff Number"))
            idx_qty   = _find_idx_by_names(header_row, ("数量", "Quantity"))
            idx_unit  = _find_idx_by_names(header_row, ("上代", "Unit Price"))
            idx_amt   = _find_idx_by_names(header_row, ("金額", "Amount"))
        
            # Anchor row: "COMMERCIAL GOODS TOTAL:"
            anchor = None
            for r in list(tbody.rows):
                if r.cells.length and r.cells[0].textContent.strip() == "COMMERCIAL GOODS TOTAL:":
                    anchor = r
                    break
            if not anchor:
                return
        
            def find_insert_point_after_anchor():
                node = anchor.nextSibling
                while node and getattr(node, "nodeType", 0) != 1:
                    node = node.nextSibling
                return node
        
            def row_has_selection(r):
                if idx_desc < 0:
                    return False
                sel = r.cells[idx_desc].querySelector("select")
                return bool(sel and sel.value and sel.value.strip())
        
            def create_dynamic_row():
                tr = js.document.createElement("tr")
                tr.className = "post-goods-row"
                for _ in range(col_count):
                    tr.appendChild(js.document.createElement("td"))
                apply_hidden_cells(tr)
        
                # Dropdown
                if idx_desc >= 0:
                    sel = js.document.createElement("select")
                    for opt in GOODS_OPTIONS:
                        o = js.document.createElement("option")
                        o.value = opt
                        o.textContent = opt
                        sel.appendChild(o)
                    tr.cells[idx_desc].innerHTML = ""
                    tr.cells[idx_desc].appendChild(sel)
        
                # HS (readonly)
                if idx_hs >= 0:
                    hs_in = js.document.createElement("input")
                    hs_in.type = "text"
                    hs_in.readOnly = True
                    hs_in.placeholder = "--"
                    tr.cells[idx_hs].innerHTML = ""
                    tr.cells[idx_hs].appendChild(hs_in)
        
                # Quantity
                if idx_qty >= 0:
                    qty_in = js.document.createElement("input")
                    qty_in.type = "number"; qty_in.min = "0"; qty_in.step = "1"
                    qty_in.style.textAlign = "right"
                    tr.cells[idx_qty].innerHTML = ""
                    tr.cells[idx_qty].appendChild(qty_in)
        
                # Unit Price
                if idx_unit >= 0:
                    unit_in = js.document.createElement("input")
                    unit_in.type = "number"; unit_in.min = "0"; unit_in.step = "1"
                    unit_in.style.textAlign = "right"
                    tr.cells[idx_unit].innerHTML = ""
                    tr.cells[idx_unit].appendChild(unit_in)
        
                # Amount (computed)
                if idx_amt >= 0:
                    amt_span = js.document.createElement("span")
                    amt_span.textContent = ""
                    tr.cells[idx_amt].innerHTML = ""
                    tr.cells[idx_amt].appendChild(amt_span)
        
                # Helpers
                def compute_and_update_amount():
                    if idx_qty < 0 or idx_unit < 0 or idx_amt < 0:
                        return
                    q_el = tr.cells[idx_qty].querySelector("input")
                    u_el = tr.cells[idx_unit].querySelector("input")
                    a_el = tr.cells[idx_amt].querySelector("span")
                    q = _parse_num(q_el.value if q_el else "0")
                    u = _parse_num(u_el.value if u_el else "0")
                    val = q * u
                    a_el.textContent = _format_jpy(val)
                    a_el.setAttribute("data-num", str(val))
        
                def on_desc_change(evt):
                    # Set HS from choice
                    if idx_desc >= 0 and idx_hs >= 0:
                        choice = (tr.cells[idx_desc].querySelector("select").value or "").strip()
                        tr.cells[idx_hs].querySelector("input").value = HS_GOODS_MAP.get(choice, "")
                    compute_and_update_amount()
                    enforce_single_blank_row()     # <-- keep exactly one blank row
                    recompute_no_goods_summary()
        
                def on_number_change(evt):
                    compute_and_update_amount()
                    recompute_no_goods_summary()
        
                # Listeners
                if idx_desc >= 0:
                    tr.cells[idx_desc].querySelector("select").addEventListener("change", create_proxy(on_desc_change))
                if idx_qty >= 0:
                    tr.cells[idx_qty].querySelector("input").addEventListener("input", create_proxy(on_number_change))
                if idx_unit >= 0:
                    tr.cells[idx_unit].querySelector("input").addEventListener("input", create_proxy(on_number_change))
        
                return tr
        
            def enforce_single_blank_row():
                """Ensure there is **exactly one** blank (unselected) dropdown row."""
                rows = [r for r in list(tbody.rows) if "post-goods-row" in (r.getAttribute("class") or "")]
                if not rows:
                    # create first blank
                    tr = create_dynamic_row()
                    ref = find_insert_point_after_anchor()
                    tbody.insertBefore(tr, ref) if ref else tbody.appendChild(tr)
                    return
        
                blanks = [r for r in rows if not row_has_selection(r)]
                if len(blanks) == 0:
                    # no blanks -> add one after the last row
                    last = rows[-1]
                    tr = create_dynamic_row()
                    if last.nextSibling:
                        tbody.insertBefore(tr, last.nextSibling)
                    else:
                        tbody.appendChild(tr)
                elif len(blanks) > 1:
                    # too many blanks -> keep the last blank, remove earlier ones
                    for r in blanks[:-1]:
                        tbody.removeChild(r)
        
            def recompute_no_goods_summary():
                qty_sum = 0.0
                amt_sum = 0.0
                for r in list(tbody.rows):
                    if "post-goods-row" not in (r.getAttribute("class") or ""):
                        continue
                    if not row_has_selection(r):
                        continue
                    if idx_qty >= 0:
                        q_el = r.cells[idx_qty].querySelector("input")
                        qty_sum += _parse_num(q_el.value if q_el else "0")
                    if idx_amt >= 0:
                        a_el = r.cells[idx_amt].querySelector("span")
                        amt_sum += _parse_num(a_el.getAttribute("data-num") if a_el else "0")
        
                # Find or create summary row
                summary = None
                for r in list(tbody.rows):
                    if r.getAttribute("id") == "no-goods-summary":
                        summary = r
                        break
                if summary is None:
                    summary = js.document.createElement("tr")
                    summary.setAttribute("id", "no-goods-summary")
                    for _ in range(col_count):
                        summary.appendChild(js.document.createElement("td"))
                    apply_hidden_cells(summary)  # mirror hidden columns
        
                    # label
                    target_cell = summary.cells[idx_style] if idx_style >= 0 else summary.cells[0]
                    target_cell.textContent = "NO COMMERCIAL GOODS TOTAL:"
                    target_cell.style.fontWeight = "700"
        
                    # place it after the last post-goods row (or right after anchor)
                    rows = [r for r in list(tbody.rows) if "post-goods-row" in (r.getAttribute("class") or "")]
                    insert_after = rows[-1] if rows else anchor
                    if insert_after and insert_after.nextSibling:
                        tbody.insertBefore(summary, insert_after.nextSibling)
                    else:
                        tbody.appendChild(summary)
        
                # write totals
                if idx_qty >= 0:
                    summary.cells[idx_qty].textContent = str(int(round(qty_sum)))
                    summary.cells[idx_qty].style.textAlign = "right"
                    summary.cells[idx_qty].style.fontWeight = "700"
                if idx_amt >= 0:
                    summary.cells[idx_amt].textContent = _format_jpy(amt_sum)
                    summary.cells[idx_amt].style.textAlign = "right"
                    summary.cells[idx_amt].style.fontWeight = "700"
                summary.style.borderTop = "2px solid #000"
        
            # initialize
            enforce_single_blank_row()
            recompute_no_goods_summary()
            
            


        # ─────────────────────────────────────────────────────────────
        # MAIN
        # ─────────────────────────────────────────────────────────────
        def process_file(file_data):
            try:
                js.document.getElementById("loading").style.display = "block"
    
                # decode
                file_bytes = base64.b64decode(file_data.split(',')[1])
                excel_file = io.BytesIO(file_bytes)
    
                # 1) Read full data
                df_raw = pd.read_excel(excel_file)
    
                # 2) Compute HS codes from full context
                if "品番" in df_raw.columns:
                    cols_needed = set(["品番","品名","Item Description","アイテム","性別","素材1","Knit / Woven"]) & set(df_raw.columns)
                    df_rep = df_raw[list(cols_needed)].groupby("品番", as_index=False).first()
                    df_rep["HSコード"] = df_rep.apply(match_hs_code_rule, axis=1)
                    hs_map = dict(zip(df_rep["品番"], df_rep["HSコード"]))
                else:
                    hs_map = {}
    
                # 3) Build display (hide columns AFTER logic)
                user_exclude = [
                    "指示No","C/No.","品名","SKU","JAN","アイテム","No","Page Title","Handle","性別","表示","素材1",
                    "混率1","素材2","混率2","素材3","混率3","素材4","混率4","素材5","混率5","素材6","混率6",
                    "素材7","混率7","素材8","混率8","素材9","混率9","素材10","Knit / Woven","原産国"
                ]
                hide_country_requested = ("原産国" in user_exclude)
    
                # columns to show (keep 原産国 for grouping/headers)
                columns_to_show = []
                for c in df_raw.columns:
                    if c == "原産国":
                        columns_to_show.append(c)
                    elif c not in user_exclude:
                        columns_to_show.append(c)
    
                df_filtered = df_raw.loc[:, columns_to_show].copy()
    
                # totals
                total_qty = None
                total_amount_val = None
    
                if "品番" in df_filtered.columns:
                    agg = {}
                    for c in df_filtered.columns:
                        if c == "品番":
                            continue
                        elif c in ["数量", "金額"]:
                            agg[c] = "sum"
                        elif c in ["上代"]:
                            agg[c] = "first"
                        else:
                            agg[c] = "first"
                    df_grouped = df_filtered.groupby("品番", as_index=False).agg(agg)
    
                    if "数量" in df_grouped.columns:
                        total_qty = pd.to_numeric(df_grouped["数量"], errors="coerce").fillna(0).sum()
    
                    if "上代" in df_grouped.columns:
                        df_grouped["上代"] = (df_grouped["上代"] * 0.42 / 10).round() * 10
                        df_grouped["上代"] = df_grouped["上代"].astype(int)
                        df_grouped["上代"] = "JPY " + df_grouped["上代"].apply(lambda x: f"{x:,}")
    
                    if "金額" in df_grouped.columns:
                        df_grouped["_金額_val"] = (df_grouped["金額"] * 0.42 / 10).round() * 10
                        total_amount_val = int(pd.to_numeric(df_grouped["_金額_val"], errors="coerce").fillna(0).sum())
                        df_grouped["金額"] = df_grouped["_金額_val"].astype(int)
                        df_grouped["金額"] = "JPY " + df_grouped["金額"].apply(lambda x: f"{x:,}")
                        df_grouped = df_grouped.drop(columns=["_金額_val"])
    
                    # attach HS
                    df_grouped["HSコード"] = df_grouped["品番"].map(hs_map).fillna("N/A")
    
                    # reorder columns
                    desired = ["品番", "Item Description", "HSコード", "数量", "上代", "金額"]
                    desired_present = [c for c in desired if c in df_grouped.columns]
                    remaining = [c for c in df_raw.columns if c in df_grouped.columns and c not in desired_present]
                    final_cols = desired_present + remaining
                    df_final = df_grouped.loc[:, final_cols].copy()
    
                    # country-driven sort (still fine)
                    if "原産国" in df_final.columns:
                        df_final["_country_key"] = df_final["原産国"].fillna("").map(country_key)
                        counts = df_final["_country_key"].value_counts()
                        others = [k for k in counts.index if k != "JAPAN"]
                        others_sorted = sorted(others, key=lambda k: (-counts[k], k))
                        ordered_keys = (["JAPAN"] if "JAPAN" in counts.index else []) + others_sorted
                        rank = {k: i for i, k in enumerate(ordered_keys)}
                        df_final["_country_rank"] = df_final["_country_key"].map(rank).fillna(9999)
                        sort_cols = ["_country_rank"] + ([col for col in ["品番"] if col in df_final.columns])
                        df_final = df_final.sort_values(by=sort_cols, kind="stable")
                        df_final = df_final.drop(columns=[c for c in ["_country_key","_country_rank"] if c in df_final.columns])
                else:
                    df_final = df_filtered
    
                # 3b) Header translation to English
                header_rename = {
                    "品番": "Style No.",
                    "Item Description": "Description of Good",
                    "HSコード": "Harmonized Tariff Number",
                    "数量": "Quantity",
                    "上代": "Unit Price",
                    "金額": "Amount",
                }
                df_final = df_final.rename(columns=header_rename)
    
                total_amount_str = f"JPY {total_amount_val:,}" if total_amount_val is not None else None
    
                # 4) Render ONE table with id="main-table"
                sheet = js.document.getElementById("sheet")
                html = df_final.to_html(index=False, classes='dataframe', table_id='main-table')
                sheet.innerHTML = html
    
                # 4b) Insert 14 pre-header rows INSIDE thead of the same table
                insert_preheader_rows_into_thead([
                    {"left": "Messers:",           "right": "Heritage R LTD."},
                    {"left": "Head Office:",       "right": "36/F, TOWER 2,THE GATEWAY,25 CANTON ROAD,TSIM SHA TSUI,"},
                    {"right": "KOWLOON,HONG KONG"},
                    {"right": "TEL; 852-2956-3266  FAX; 852-2956-1230"},
                    {"left": "Final Destination:", "right": "FENIX LOGISTICS LTD."},
                    {"right": "4/F,CHUAN KEI FACTORY BUILDING, 15-23 KIN HONG STREET,"},
                    {"right": "KWAI CHUNG, N.T., HONG KONG "},
                    {"right": "TEL; 852-2127-4660    ATTN. KAWA(MR.) / KIT(MR.)"},
                    {"left": "Shipped per:",       "right": "AIR"},
                    {"left": "Customs clearance"},
                    {"left": "FROM:",              "right": "TOKYO"},
                    {"left": "TO:",                "right": "HONG KONG"},
                    {"left": "PAYMENT:",           "right": "T/T AT SIGHT"},
                    # 14th will be auto-padded if needed
                ])

                setup_preheader_widgets()
    
                # 5) Country headers (uses 原産国)
                if "原産国" in df_final.columns:
                    insert_country_headers("原産国")
    
                # 6) Row under header in tbody
                insert_row_under_header(
                    col_name_left="Style No.",
                    text_left="COMMERCIAL VALUE",
                    col_name_right="Amount",
                    text_right="F.O.B TOKYO"
                )
    
                # 7) Totals row
                append_totals_row(
                    first_cell_text="COMMERCIAL GOODS TOTAL:",
                    qty_col_name="Quantity",
                    amount_col_name="Amount",
                    total_qty=total_qty,
                    total_amount_str=total_amount_str
                )

                # 7b) Interactive section for additional commercial goods (+ summary)
                build_dynamic_goods_section()

    
                # 8) Spacer + “(N) Carton”
                max_carton = safe_max_carton(df_raw)
                append_carton_rows_to_table(max_carton)
    
                # 9) Hide 原産国 everywhere (thead + tbody)
                if hide_country_requested:
                    hide_table_column("原産国")
    
                js.document.getElementById("loading").style.display = "none"
                print("File processed successfully!")
                print(f"Rows: {len(df_final)}")
    
            except Exception as e:
                sheet = js.document.getElementById("sheet")
                sheet.innerHTML = f"<p style='color: red;'>Error: {str(e)}</p>"
                js.document.getElementById("loading").style.display = "none"
                import traceback; traceback.print_exc()
    
        js.window.processExcelFile = create_proxy(process_file)
    </script>



    <script src="https://unpkg.com/filepond-plugin-file-encode/dist/filepond-plugin-file-encode.min.js"></script>
    <script src="https://unpkg.com/filepond-plugin-file-validate-size/dist/filepond-plugin-file-validate-size.min.js"></script>
    <script src="https://unpkg.com/filepond/dist/filepond.min.js"></script>
    
    <script>
        FilePond.registerPlugin(
            FilePondPluginFileEncode,
            FilePondPluginFileValidateSize,
            FilePondPluginImageExifOrientation,
            FilePondPluginImagePreview
        );

        const pond = FilePond.create(
            document.querySelector('input'),
            {
                credits: false,
                onaddfile: (error, file) => {
                    if (!error && window.processExcelFile) {
                        const fileData = file.getFileEncodeDataURL();
                        window.processExcelFile(fileData);
                    }
                }
            }
        );
    </script>
</body>
</html>
